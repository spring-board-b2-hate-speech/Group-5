import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.preprocessing import LabelEncoder
#Load the dataset
data = pd.read_csv('Preprocessed_Final_dataset.csv',encoding = 'latin1')
data.head()
# Transform text to TF-IDF features with a limit on max features
tfidf_vectorizer = TfidfVectorizer()
X = tfidf_vectorizer.fit_transform(data['text'])
# Encode the labels
label_encoder = LabelEncoder()
y = label_encoder.fit_transform(data['label'])
tfidf_df['label'] = y
# Concatenate the original data (with clean text) and TF-IDF DataFrame
result_df = pd.concat([data.reset_index(drop=True), tfidf_df], axis=1)
print("Concatenated DataFrame preview:")
print(result_df.head())
